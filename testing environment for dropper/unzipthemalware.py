import py7zr

# Path to the password-protected 7z archive
archive_path = "C:\\Users\\0x00\\Downloads\\Python-3.11.5_Installer.7z"

# Password for the archive
password = '5P3rc3nt'

# Destination directory where the contents will be extracted
output_dir = 'C:\\Users\\0x00\\Desktop'

try:
    with py7zr.SevenZipFile(archive_path, mode='r', password=password) as archive:
        archive.extractall(output_dir)
    print(f"Successfully extracted contents to {output_dir}")
except py7zr.exceptions.PasswordRequired as e:
    print("Error: Password is required to extract the archive.")
except py7zr.exceptions.Bad7zFile as e:
    print("Error: The file is not a valid 7z archive or the password is incorrect.")
except Exception as e:
    print(f"An error occurred: {str(e)}")