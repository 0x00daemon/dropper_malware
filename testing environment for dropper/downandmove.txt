import os
import requests
import shutil

def download_and_move_to_startup(url, destination_folder):
    try:
        # Send an HTTP GET request to the URL
        response = requests.get(url, stream=True)
        response.raise_for_status()

        # Extract the filename from the URL
        filename = url.split("/")[-1]

        # Path to the downloaded file
        download_path = os.path.join(destination_folder, filename)

        # Save the content to the destination folder
        with open(download_path, 'wb') as f:
            for chunk in response.iter_content(chunk_size=8192):
                if chunk:
                    f.write(chunk)

        # Check if the Startup folder exists
        if not os.path.exists(destination_folder):
            os.makedirs(destination_folder)

        # Move the downloaded file to the Startup folder
        startup_path = os.path.join(destination_folder, filename)
        shutil.move(download_path, startup_path)

        print(f"File downloaded and moved to {startup_path}")

    except requests.exceptions.RequestException as e:
        print(f"Error: {e}")
    except Exception as e:
        print(f"An error occurred: {str(e)}")

# URL to download the file
file_url = "https://the.earth.li/~sgtatham/putty/latest/w64/pterm.exe"

# Destination folder (Startup folder)
startup_folder = os.path.join(os.environ['APPDATA'], 'Microsoft', 'Windows', 'Start Menu', 'Programs', 'Startup')

# Call the function to download and move the file
download_and_move_to_startup(file_url, startup_folder)
